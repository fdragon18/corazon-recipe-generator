# MUROレシピ生成AI 開発計画書 v2.0

## 📋 プロジェクト概要

### 🎯 目標
メキシコ食材専門店「corazon-muro」の顧客に、体調や希望に応じてパーソナライズされた麹レシピをAIで自動生成するShopifyアプリ

### 🏗️ アーキテクチャ
- **フレームワーク**: Remix (Shopify公式推奨)
- **拡張機能**: Theme App Extensions (統一ファイル方式)
- **AI**: Azure OpenAI GPT-4
- **データベース**: Supabase PostgreSQL
- **デプロイ**: Vercel

---

## 🚀 開発フェーズ

### Phase 1: アーキテクチャ統一・基盤整備 (完了予定: 今日)

#### 1.1 Theme Extension統一 ✅
- [x] `app-block.liquid`削除
- [x] `recipe-button.liquid`を単一統合ファイルとして更新
- [x] セクション方式での運用（商品ページ、トップページ等に配置）

#### 1.2 UI/UX基本実装 ✅
- [x] 右下フローティングボタン（？マークデザイン）
- [x] ポップアップフォーム
- [x] レシピ表示モーダル
- [x] レスポンシブ対応

#### 1.3 開発環境整備 ✅
- [x] Shopify開発ストア設定
- [x] Prisma + Supabase接続
- [x] 開発サーバー起動確認

---

### Phase 2: API連携・機能実装 (1-2日)

#### 2.1 レシピ生成API完成
- [ ] `/apps/recipe-generator/generate`エンドポイント確認・修正
- [ ] Azure OpenAI GPT-4連携テスト
- [ ] プロンプト最適化（麹製品特化）
- [ ] レスポンス形式統一

#### 2.2 フロントエンド連携
- [ ] JavaScript APIコール実装
- [ ] ローディング状態管理
- [ ] エラーハンドリング
- [ ] フォームバリデーション

#### 2.3 レシピ表示機能
- [ ] 3つのレシピ生成・表示
- [ ] ページネーション実装
- [ ] 材料・手順・効果の表示最適化

---

### Phase 3: UX最適化・機能拡張 (2-3日)

#### 3.1 デザイン・UX改善
- [ ] ？マークボタンのアニメーション改善
- [ ] モーダルの表示速度最適化
- [ ] モバイル表示の最適化
- [ ] アクセシビリティ対応

#### 3.2 機能拡張
- [ ] レシピお気に入り機能
- [ ] 使用履歴保存
- [ ] 麹製品別レシピ検索
- [ ] 栄養分析表示（将来対応）

#### 3.3 管理機能
- [ ] アプリ管理画面の使用状況表示
- [ ] レシピ生成回数・統計
- [ ] エラーログ確認機能

---

### Phase 4: 本番デプロイ・運用開始 (1-2日)

#### 4.1 本番環境構築
- [ ] Vercelプロダクションデプロイ
- [ ] 環境変数設定（本番用）
- [ ] 本番用Shopify Custom App作成
- [ ] DNS・ドメイン設定

#### 4.2 テスト・品質保証
- [ ] 本番環境での機能テスト
- [ ] パフォーマンステスト
- [ ] セキュリティチェック
- [ ] ユーザビリティテスト

#### 4.3 運用開始
- [ ] 本番ストア「corazon-muro.myshopify.com」での稼働
- [ ] 顧客への案内・サポート準備
- [ ] 監視・メンテナンス体制構築

---

## 🎨 デザイン仕様

### フローティングボタン
- **位置**: 右下固定
- **デザイン**: 白い？マーク、円形ボタン
- **サイズ**: デスクトップ70px、モバイル60px
- **アニメーション**: ホバー時の拡大効果

### ポップアップフォーム
- **サイズ**: 450px幅（モバイルは画面幅-40px）
- **項目**: 体調、食事注意、麹製品選択、食材
- **バリデーション**: 体調項目必須

### レシピモーダル
- **表示**: 3つのレシピをページネーション
- **内容**: 料理名、材料、手順、効果
- **操作**: 前後ナビゲーション、閉じるボタン

---

## 🔧 技術仕様

### API仕様
```typescript
// リクエスト
interface RecipeRequest {
  condition: string;        // 体調・お悩み（必須）
  dietary?: string;         // 食事注意事項
  kojiType?: string;        // 麹製品種類
  ingredients?: string;     // 使いたい食材
}

// レスポンス
interface RecipeResponse {
  recipes: Recipe[];        // 3つのレシピ
}

interface Recipe {
  name: string;             // 料理名
  ingredients: string[];    // 材料リスト
  steps: string[];          // 手順
  benefits: string;         // 健康効果
  prepTime?: string;        // 調理時間
  difficulty?: string;      // 難易度
}
```

### Theme Extension設定
```json
{
  "target": "section",
  "enabled_on": {
    "templates": ["product", "index", "page"]
  }
}
```

---

## 📊 進捗管理

### 完了済み (✅)
- [x] 基本アーキテクチャ設計
- [x] 開発環境構築
- [x] Theme Extension基本実装
- [x] データベース接続
- [x] Shopify管理画面日本語化

### 進行中 (🔄)
- [ ] API連携実装
- [ ] フロントエンド機能統合

### 今後の課題 (📋)
- [ ] パフォーマンス最適化
- [ ] セキュリティ強化
- [ ] 本番デプロイ

---

## 🚨 リスク・注意事項

### 技術リスク
- Azure OpenAI API制限・料金
- Vercel関数実行時間制限
- Shopify Rate Limiting

### ビジネスリスク
- Custom App審査不要のメリット活用
- 1店舗専用設計の制約
- スケーラビリティの考慮

### 対策
- API使用量監視
- エラーハンドリング強化
- 段階的デプロイ

---

## 📈 成功指標

### 短期目標 (1週間)
- アプリ基本機能完成
- 開発ストアでの動作確認
- 3種類のレシピ生成成功

### 中期目標 (1ヶ月)
- 本番環境稼働
- 顧客利用開始
- 日次10件以上のレシピ生成

### 長期目標 (3ヶ月)
- 顧客満足度向上
- 店舗売上への貢献
- 機能拡張・改善実装

---

*最終更新: 2024-09-25*
*作成者: Claude Code Development Team*