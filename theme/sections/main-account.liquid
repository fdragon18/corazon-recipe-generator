{%- paginate customer.orders by 20 -%}

<div class="page-width page-content">

  {%- for block in section.blocks -%}
    {% case block.type %}
      {% when 'title'%}
        <header class="section-header{% unless settings.type_headers_align_text %} section-header--with-link{% endunless %}">
          <h1 class="section-header__title">{{ 'customer.account.title' | t }}</h1>
        </header>

        {% if block.settings.marigin_bottom_off %}
          <style>
            #shopify-section-{{ section.id }} .section-header {
              margin-bottom: 15px;
            }
          </style>
        {% endif %}

      {% when 'contents'%}
        <div class="grid">
        
          <div class="grid__item medium-up--two-thirds">
            <h2>{{ 'customer.orders.title' | t }}</h2>
        
            {%- if customer.orders.size != 0 -%}
        
              <table class="table--responsive table--small-text">
                <thead>
                  <tr>
                    <th>{{ 'customer.orders.order_number' | t }}</th>
                    <th>{{ 'customer.orders.date' | t }}</th>
                    <th>{{ 'customer.orders.payment_status' | t }}</th>
                    <th>{{ 'customer.orders.fulfillment_status' | t }}</th>
                    <th>{{ 'customer.orders.total' | t }}</th>
                  </tr>
                </thead>
                <tbody>
                  {%- for order in customer.orders -%}
                    <tr class="table__section">
                      <td data-label="{{ 'customer.orders.order_number' | t }}">{<a href="{{ order.customer_url }}" data-order-id="{{ order.id }}">{{ order.name }}</a></td>
                      <td data-label="{{ 'customer.orders.date' | t }}">{{ order.created_at | time_tag: format: 'date' }}</td>
                      <td data-label="{{ 'customer.orders.payment_status' | t }}">{{ order.financial_status_label }}</td>
                      <td data-label="{{ 'customer.orders.fulfillment_status' | t }}">{{ order.fulfillment_status_label }}</td>
                      <td data-label="{{ 'customer.orders.total' | t }}">{{ order.total_price | money }}</td>
                    </tr>
                  {%- endfor -%}
                </tbody>
              </table>
        
              <hr class="hr--clear">
        
            {%- else -%}
        
              <p>{{ 'customer.orders.none' | t }}</p>
        
            {%- endif -%}
          </div>
        
          <div class="grid__item medium-up--one-third">
            <h3>{{ 'customer.account.details' | t }}</h3>
        
            <p class="h5">{{ customer.name }}</p>
        
            {{ customer.default_address | format_address }}
        
            <p><a href="{{ routes.account_addresses_url }}" class="text-link">{{ 'customer.account.view_addresses' | t }} ({{ customer.addresses_count }})</a></p>
          </div>
        
        </div>

      {% when '@app'%}
        {% render block %}
      
    {% endcase %}
  {% endfor %}

  {%- if paginate.pages > 1 -%}
    {%- render 'pagination', paginate: paginate -%}
  {%- endif -%}
<p><a href="/account?hbSubscriptionPath=/">定期購買一覧</a></p><a href="{{ routes.account_logout_url }}" class="btn btn--secondary btn--small section-header__link">{{ 'layout.customer.log_out'| t }}</a>
<div id="huckleberry-subscription-customer-portal-wrap">
   <p><a href="{{ routes.account_url }}">アカウントに戻る</a></p>
   <div id="huckleberry-subscription-customer-portal"></div>
</div>
</div>
{%- endpaginate -%}
  <style>
    .section-header__link {
      border: none;
      padding: 0;
      margin: 0;
      margin-top: 50px;
    }
  </style>
{% if section.settings.app_marigin_bottom_on %}
  <style>
    #shopify-section-{{ section.id }} .shopify-app-block {
      margin-bottom: 50px;
    }
    @media (max-width: 768px) {
      #shopify-section-{{ section.id }} .shopify-app-block {
        margin-bottom: 30px;
      }
    }
  </style>
{% endif %}

{% schema %}
  {
    "name": "Main account",
    "settings": [
      {
        "type": "checkbox",
        "id": "app_marigin_bottom_on",
        "label": "アプリのブロックの下マージンを追加する",
        "default": true
      }
    ],
    "blocks": [
      {
        "type": "title",
        "name": "タイトル",
        "settings": [
          {
            "type": "checkbox",
            "id": "marigin_bottom_off",
            "label": "下マージンをなくす",
            "default": false
          }
        ]
      },
      {
        "type": "contents",
        "name": "コンテンツ"
      },
      {
        "type": "@app"
      }
    ],
    "presets": [
      {
        "name": "Main account",
        "blocks": [
          {
            "type": "title"
          },
          {
            "type": "contents"
          }
        ]
      }
    ]
  }
{% endschema %}